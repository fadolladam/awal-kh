<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KhmerNote - ឌូអា</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts: Inter (UI) + Suwannaphum (Khmer Article Font) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Suwannaphum:wght@100;300;400;700;900&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f0f2f5; /* Light gray background for the entire page */
      padding-bottom: 80px; /* Increased padding to accommodate sticky footer */
    }

    .suwannaphum {
      font-family: 'Suwannaphum', serif;
    }

    .suwannaphum-light {
      font-family: 'Suwannaphum', serif;
      font-weight: 300;
    }

    .suwannaphum-regular {
      font-family: 'Suwannaphum', serif;
      font-weight: 400;
    }

    .suwannaphum-bold {
      font-family: 'Suwannaphum', serif;
      font-weight: 700;
    }

    .suwannaphum-black {
      font-family: 'Suwannaphum', serif;
      font-weight: 900;
    }

    /* Styles for the active navigation icon */
    .nav-item.active {
        color: #1a73e8; /* Deeper blue for active icon */
    }

    /* Collapsible content styles */
    .collapse-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
    }

    .collapse-content.active {
        max-height: 500px; /* Adjust based on expected content height */
        transition: max-height 0.5s ease-in;
    }

    .collapse-header {
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem; /* Adjust padding as needed */
    }

    .collapse-header svg {
        transition: transform 0.3s ease-out;
    }

    .collapse-header.active svg {
        transform: rotate(90deg); /* Rotate arrow when active */
    }

    .dua-category-card {
        background-color: white;
        border-radius: 1rem; /* rounded-2xl */
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
        padding: 1.5rem; /* p-6 */
        margin-bottom: 1.5rem; /* mb-6 */
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- TOP BAR / HEADER - Similar to Athan page -->
  <header class="bg-white py-3 px-4 shadow-sm flex justify-between items-center relative z-10 text-gray-800 font-semibold text-lg">
    <div class="flex items-center text-sm">
      <span id="current-hour-minute" class="font-bold">10:12</span>
      <svg class="h-4 w-4 ml-1 text-gray-500" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M12.001 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-1 17h-2v-6h2v6zm1-10c-.552 0-1-.448-1-1s.448-1 1-1 1 .448 1 1-.448 1-1 1z"/>
      </svg>
      <svg class="h-4 w-4 ml-1 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.24-.964M4.5 12C4.5 7.582 8.53 4 13.5 4c1.691 0 3.246.336 4.607.935"></path>
      </svg>
      <svg class="h-4 w-4 ml-1 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13l-3 3m0 0l-3-3m3 3V8m0 4v.01M6 19l2-2m0 0l4-4 4 4 2 2M3 19h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v10a2 2 0 002 2z"/>
      </svg>
    </div>
    <div class="text-center flex-grow">
      <span class="text-gray-800 font-semibold text-base">ឌូអា</span> <!-- Page Title -->
    </div>
    <div class="flex items-center space-x-3">
      <svg class="h-6 w-6 text-gray-600 cursor-pointer" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464A9 9 0 0012 3C7.029 3 3 7.029 3 12s4.029 9 9 9a8.988 8.988 0 007.536-3.964M12 21V3m0 0l3 3m-3-3l-3 3"></path>
      </svg>
      <svg class="h-6 w-6 text-gray-600 cursor-pointer" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.882 13.2 9 13.068 9 12.5v-1a.5.5 0 00-.096-.288l-.723-.723.723-.723A.5.5 0 009 9.5v-1c0-.568-.118-.7-.282-.842m6.566 0c.164.142.282.274.282.842v1c0 .568-.118.7-.282.842M12 12v.01"></path>
      </svg>
    </div>
  </header>

  <!-- MAIN Content for Duas -->
  <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-6 flex flex-col items-center">
    <div class="max-w-md w-full">
      <h2 class="text-2xl font-bold text-gray-900 mb-6 text-center suwannaphum">បណ្តុំឌូអា</h2>

      <div id="dua-content-container">
        <!-- Duas will be dynamically loaded here -->
        <div id="loading-duas" class="text-center text-gray-500 text-lg py-10">កំពុងផ្ទុកឌូអា...</div>
        <div id="error-loading-duas" class="text-center text-red-500 text-lg py-10 hidden">បរាជ័យក្នុងការផ្ទុកឌូអា. សូម​ព្យាយាម​ម្តង​ទៀត​នៅ​ពេល​ក្រោយ។</div>
      </div>
      
    </div>
  </main>

  <!-- Sticky Bottom Navigation -->
  <footer class="fixed bottom-0 left-0 right-0 w-full bg-white shadow-2xl py-4 px-4 z-40 rounded-t-xl">
    <nav class="flex justify-around items-center h-full">
      <!-- Home Icon -->
      <a href="#" class="nav-item flex flex-col items-center text-gray-600 hover:text-blue-600 transition-colors duration-200 p-2">
        <svg class="h-6 w-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
        </svg>
        <span class="text-xs font-medium suwannaphum-regular">ទំព័រដើម</span>
      </a>

      <!-- Prayer Icon -->
      <a href="#" class="nav-item flex flex-col items-center text-gray-600 hover:text-blue-600 transition-colors duration-200 p-2">
        <svg class="h-6 w-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span class="text-xs font-medium suwannaphum-regular">ម៉ោងបន់ស្រន់</span>
      </a>

      <!-- Al Quran Icon -->
      <a href="#" class="nav-item flex flex-col items-center text-gray-600 hover:text-blue-600 transition-colors duration-200 p-2">
        <svg class="h-6 w-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6a2 2 0 110-4 2 2 0 010 4zm0 0v14"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 12l-2 2-2-2"></path>
        </svg>
        <span class="text-xs font-medium suwannaphum-regular">អាល់គូរអាន</span>
      </a>

      <!-- Duas Icon (Active) -->
      <a href="#" class="nav-item flex flex-col items-center text-gray-600 hover:text-blue-600 transition-colors duration-200 active p-2">
        <svg class="h-6 w-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11.586 11.586m-2.828-2.828a4 4 0 014-4h2.828" />
        </svg>
        <span class="text-xs font-medium suwannaphum-regular">ឌូអា</span>
      </a>

      <!-- More Icon -->
      <a href="#" class="nav-item flex flex-col items-center text-gray-600 hover:text-blue-600 transition-colors duration-200 p-2">
        <svg class="h-6 w-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
        <span class="text-xs font-medium suwannaphum-regular">ច្រើនទៀត</span>
      </a>
    </nav>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const duaContentContainer = document.getElementById('dua-content-container');
      const loadingDuas = document.getElementById('loading-duas');
      const errorLoadingDuas = document.getElementById('error-loading-duas');

      // Function to update the header's current time display
      const updateHeaderTime = () => {
          const now = new Date();
          const hours = String(now.getHours()).padStart(2, '0');
          const minutes = String(now.getMinutes()).padStart(2, '0');
          document.getElementById('current-hour-minute').textContent = `${hours}:${minutes}`;
      };

      // Set initial time and update every minute
      updateHeaderTime();
      setInterval(updateHeaderTime, 60000);

      // Function to dynamically render Duas
      const renderDuas = (duaCategories) => {
        duaContentContainer.innerHTML = ''; // Clear loading/error messages and previous content

        duaCategories.forEach(category => {
          const categoryCard = document.createElement('div');
          categoryCard.className = 'dua-category-card';
          categoryCard.innerHTML = `
            <h3 class="text-xl font-bold text-gray-800 mb-4 suwannaphum">${category.categoryTitleKhmer}</h3>
          `;

          category.duas.forEach(dua => {
            const duaItem = document.createElement('div');
            duaItem.className = 'border-b border-gray-200 last:border-b-0 py-2';
            duaItem.innerHTML = `
              <div class="collapse-header py-2" data-target="${dua.id}">
                <div class="flex items-center">
                  ${dua.iconSvg}
                  <span class="text-lg font-medium text-gray-700 suwannaphum-regular">${dua.titleKhmer}</span>
                </div>
                <svg class="h-5 w-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </div>
              <div id="${dua.id}" class="collapse-content px-2">
                <p class="text-gray-800 suwannaphum-regular text-right rtl:text-right" dir="rtl">${dua.arabic}</p>
                <p class="text-sm text-gray-600 mt-2 suwannaphum-regular">${dua.khmerMeaning}</p>
                <p class="text-xs text-gray-500 mt-2">Source: ${dua.source}</p>
              </div>
            `;
            categoryCard.appendChild(duaItem);
          });
          duaContentContainer.appendChild(categoryCard);
        });

        // Re-attach collapsible functionality to newly rendered elements
        document.querySelectorAll('.collapse-header').forEach(header => {
          header.addEventListener('click', () => {
            const targetId = header.dataset.target;
            const content = document.getElementById(targetId);
            if (content) {
              header.classList.toggle('active');
              content.classList.toggle('active');
            }
          });
        });
      };

      // Fetch Duas from JSON file
      const fetchDuas = async () => {
        loadingDuas.classList.remove('hidden');
        errorLoadingDuas.classList.add('hidden');
        duaContentContainer.innerHTML = ''; // Clear previous content

        try {
          const response = await fetch('duas.json'); // Path to your JSON file
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const duasData = await response.json();
          renderDuas(duasData);
        } catch (error) {
          console.error('Error fetching duas:', error);
          errorLoadingDuas.classList.remove('hidden');
        } finally {
          loadingDuas.classList.add('hidden');
        }
      };

      // Initial fetch of duas
      fetchDuas();
    });
  </script>
</body>
</html>
